---
title: "Halloween Candies"
author: "Masood Khan"
date: "03/04/2020"
output: html_document
---



![ ](https://hips.hearstapps.com/hmg-prod.s3.amazonaws.com/images/bowl-of-halloween-candy-corns-and-jack-o-lantern-royalty-free-image-1570028595.jpg)


1.1 

# Data set

This data set is about the poll that asked people around the world about candies and chocolates, political affiliation and some personal questions.
 
1.2

# Data cleaning process
  1. clean names.
  2. remove some characters from data.
  3. change all to lowercase.
  4. pivot longer, and select columns need analysing.
  5. add year column to all 3 data set.
  6. combine data with bind-row 
  7. correct discrepancies in the country, age and gender columns with mutate.
  
1.3 

# Analysis

```{r}
library(tidyverse)
library(dplyr)
library(stringr)
library(readr)
library(here)

```


Load data from first csv file 

```{r}

halloween_candies <- 
  read_csv(here("clean_data/halloween_candies.csv"), guess_max = 1000001)


```
  
Q1 What is the total number of candy ratings given across the three years 
  
  
```{r}

halloween_candies %>%
  drop_na()%>%
  group_by(ratings)%>%
  summarise(candy_ratings = n()) %>%
  summarise(total_ratings = sum(candy_ratings))
  

```

Q2 What was the average age of people who are going out trick or treating and the average age of people 3. not going trick or treating?

```{r}

halloween_candies %>%
  drop_na() %>%
   group_by(going_out) %>%
   summarise(avg_age = mean(age, na.rm = TRUE))


```

Q3 For each of joy, despair and meh, which candy bar revived the most of these ratings?

```{r}

halloween_candies %>%
  drop_na() %>%
  group_by(ratings, candies) %>%
  summarise(candy_ratings = n()) %>%
  filter(candy_ratings == max(candy_ratings)) %>%
  top_n(1)

```

Q4 How many people rated Starburst as despair

```{r}

halloween_candies %>%
  drop_na() %>%
  filter(candies == 'starburst') %>%
  group_by(candies, ratings) %>%
  summarise(starburst_ratings = n()) %>%
  filter(ratings == 'despair')

```

Q5 What was the most popular candy bar by this rating system for each gender in the dataset?

```{r}

halloween_candies %>%
  drop_na() %>%
  filter(gender != "not given") %>%
  group_by(gender, candies) %>%
  summarise(candy_ratings = n()) %>%
  top_n(2)

```

Q6 What was the most popular candy bar in each year

```{r}

halloween_candies %>%
drop_na(ratings) %>%
group_by(year, candies) %>%
summarise(popular_ratings = n())  %>%
top_n(1)


```

Q7 What was the most popular candy bar by this rating for people in US, Canada, UK and all other countries

```{r}

halloween_candies %>%
drop_na() %>%
filter(year != 2015) %>%
group_by(country, candies) %>%
summarise(candy_ratings = n()) %>%
arrange(desc(candy_ratings)) %>%
top_n(1)


```



![ ](https://sayingimages.com/wp-content/uploads/Cat-explosion-Mission-Accomplished-Meme.jpg)








